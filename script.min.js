let scrollLock=false;function scrollToTopControlled(){if(!scrollLock){scrollLock=true;requestAnimationFrame(()=>{window.scrollTo({top:0,behavior:'smooth'});});setTimeout(()=>{scrollLock=false;},3000);}}const htmlBody=document.querySelector("html,body");const results=document.querySelector("#results");const scrollToResults=()=>{const resultsTop=results.offsetTop;htmlBody.scrollTo({top:resultsTop,behavior:"smooth",});};const searchInput=document.getElementById("search-input");const searchButton=document.getElementById("search-button");const resultsContainer=document.getElementById("results");const corsProxy="https:function optimisedImageUrl(url){return url.replace("._V1_.","._V1_QL75_UX160_.");}function fetchAndShow(){const query=encodeURIComponent(searchInput.value);const url=`${corsProxy}https:Pace.restart();fetch(url).then((response)=>response.json()).then((data)=>{const results=data.d;resultsContainer.innerHTML="";results.forEach((result)=>{if(result.i &&(result.qid==="movie" || result.qid==="tvSeries")){const resultElem=document.createElement("div");resultElem.classList.add("result");resultElem.setAttribute("IMDB",result.id);let imageAndInfo="";if(result.qid==="movie" && result.i){imageAndInfo=`<a onClick="setUrl(this);return setVideo(this);" url="imdb=${result.id}&type=movie&title=${result.l.replace(//g,"_")}" isWebSeries="false" title="${result.l}" class="links" IMDB="${result.id}" href="https:<img alt="${result.l}" src="${optimisedImageUrl(result.i.imageUrl)}"><div class="info"><h3>${result.l}</h3><p>${result.s}</p></div></a>`;}else if(result.qid==="tvSeries" && result.i){imageAndInfo=`<a onClick="setUrl(this);return setVideo(this);" url="imdb=${result.id}&season=1&episode=1&title=${result.l.replace(//g,"_")}" IMDB="${result.id}" title="${result.l}" isWebSeries="true" class="links" href="https:<img alt="${result.l}" src="${optimisedImageUrl(result.i.imageUrl)}"><div class="info"><h3>${result.l}</h3><p>${result.s}</p></div></a>`;}resultElem.innerHTML=imageAndInfo;resultsContainer.appendChild(resultElem);}});});}const fetchTitle=async(imdbID)=>{const url=`${corsProxy}https:try{const response=await fetch(url);const data=await response.json();const title=data.d[0].l;return title;}catch(error){console.error(error);}};function setUrl(element){let search=element.getAttribute("url");window.history.replaceState({},"",`?${search.replace(/%20/g,"+")}`);}function fillSearchInput(){let searchParams=new URLSearchParams(window.location.search);let search=searchParams.get("search");let season=searchParams.get("season");let episode=searchParams.get("episode");let imdb=searchParams.get("imdb");let type=searchParams.get("type");if(search && !season && !episode && !imdb){search=search.replace(/\+/g,"%20");const searchInput=document.querySelector("#search-input");searchInput.value=search;fetchAndShow();}else if(imdb && type && !search && !episode && !season){fetchTitle(imdb).then((title)=>setAll(imdb,title,season,episode,type)).catch((error)=>console.error(error));}else if(imdb && !search && episode && season){console.log("season",season,"episode",episode);fetchTitle(imdb).then((title)=>setAll(imdb,title,season,episode,type)).catch((error)=>console.error(error));console.log("season",season,"episode",episode);}}fillSearchInput();function updateURL(input){let search=input.value;if(search){window.history.replaceState({},"",`?search=${encodeURIComponent(search).replace(/%20/g,"+")}`);}else{window.history.replaceState({},"",window.location.pathname);}}function highlightCards(){let searchParams=new URLSearchParams(window.location.search);let imdb_id=searchParams.get("imdb");try{document.querySelectorAll(".result").forEach(function(card){card.className="result";});document.querySelector(`div[IMDB=${imdb_id}]`).className="result hoverClass";}catch(error){}}window.onpopstate=function(){let searchParams=new URLSearchParams(window.location.search);let search=searchParams.get("search");let imdb=searchParams.get("imdb");if(search || imdb){let elements=document.getElementsByClassName("information");for(let i=0;i<elements.length;i++){elements[i].style.display="none";}}else{let elements=document.getElementsByClassName("information");for(let i=0;i<elements.length;i++){elements[i].style.display="block";}}};let timer;searchInput.addEventListener("keyup",function(){let inputQuery=this;clearTimeout(timer);timer=setTimeout(function(){updateURL(inputQuery);fetchAndShow();window.dispatchEvent(new PopStateEvent("popstate"));scrollToResults();},500);});searchButton.addEventListener("click",function(){fetchAndShow();scrollToResults();window.dispatchEvent(new PopStateEvent("popstate"));});function episodeHighlight(cssidentification="s1e1"){document.querySelectorAll(".episodes").forEach(function(episode){episode.className="episodes";});document.querySelector(`.episodes[cssidentification='${cssidentification}']`).className="episodes selected";}const PLAYER_CONFIG={iframeId:"iframe",videoContainerId:"video",embedMovieUrl:(tmdb)=>`https:embedTvUrl:(tmdb,season,episode)=>`https:};async function fetchTmdbIdFromImdb(imdbID){const tmdbApiKey="b6b677eb7d4ec17f700e3d4dfc31d005";const url=`https:try{const response=await fetch(url);const data=await response.json();return data.movie_results && data.movie_results[0] ? data.movie_results[0].id:null;}catch(error){console.error("Failed to fetch TMDB ID:",error);return null;}}async function fetchTmdbTvIdFromImdb(imdbID){const tmdbApiKey="b6b677eb7d4ec17f700e3d4dfc31d005";const url=`https:try{const response=await fetch(url);const data=await response.json();return data.tv_results && data.tv_results[0] ? data.tv_results[0].id:null;}catch(error){console.error("Failed to fetch TMDB ID for TV show:",error);return null;}}async function setAll(imdb,title,season,episode,type){if(imdb && title && !season && !episode && type){const tmdbId=await fetchTmdbIdFromImdb(imdb);if(!tmdbId){alert("Could not find TMDB ID for this movie.");return;}let a=document.createElement("a");a.setAttribute("onClick","setUrl(this);return setVideo(this);");a.setAttribute("url",`imdb=${imdb}&type=movie&title=${title.replace(//g,"_")}`);a.setAttribute("isWebSeries","false");a.setAttribute("title",title);a.setAttribute("class","links");a.setAttribute("IMDB",imdb);a.setAttribute("href",PLAYER_CONFIG.embedMovieUrl(tmdbId));a.setAttribute("target","_blank");a.click();}else if(imdb && title && episode && !type){const tmdbId=await fetchTmdbTvIdFromImdb(imdb);if(!tmdbId){alert("Could not find TMDB ID for this TV show.");return;}let a=document.createElement("a");a.setAttribute("onClick","setUrl(this);return setVideo(this);");console.log("season setall",season,"episode",episode);a.setAttribute("url",`imdb=${imdb}&season=${season}&episode=${episode}`);a.setAttribute("isWebSeries","true");a.setAttribute("title",title);a.setAttribute("class","links");a.setAttribute("IMDB",imdb);a.setAttribute("href",PLAYER_CONFIG.embedTvUrl(tmdbId,season,episode));a.setAttribute("target","_blank");a.click();}}function setVideo(element){const iframe=document.getElementById(PLAYER_CONFIG.iframeId);const video=document.getElementById(PLAYER_CONFIG.videoContainerId);iframe.src=element.getAttribute("href");video.style.display="block";const webSeriesData=document.getElementById("webSeriesData");const tmdbApiKey="b6b677eb7d4ec17f700e3d4dfc31d005";const imdbID=element.getAttribute("IMDB");Pace.restart();scrollToTopControlled();window.dispatchEvent(new PopStateEvent("popstate"));if(element.getAttribute("isWebSeries")=="false" && element.className=="links"){webSeriesData.innerHTML="";}if(element.getAttribute("title")!==""){document.title=element.getAttribute("title");}if(element.className.includes("episode")){episodeHighlight(element.getAttribute("cssidentification"));console.log("clicked");}if(element.getAttribute("isWebSeries")=="true"){webSeriesData.innerHTML="";async function printEpisodes(){const response=await fetch(`https:);const data=await response.json();const showId=data.tv_results[0].id;const seasonsData=await fetch(`https:);const seasonsDataJSON=await seasonsData.json();const numberOfSeasons=seasonsDataJSON.number_of_seasons;webSeriesData.innerHTML+=`<h2>Seasons:</h2>`;for(let seasonNumber=1;seasonNumber<=numberOfSeasons;seasonNumber++){webSeriesData.innerHTML+=`<h3>Season ${seasonNumber}:</h3><br>`;let episodeContainer=document.createElement("div");episodeContainer.classList.add("episode-container");let episodesData="";const episodesDataResponse=await fetch(`https:);const episodesDataJSON=await episodesDataResponse.json();for(const episode of episodesDataJSON.episodes){const episodeNumber=episode.episode_number;let formatedEpisodeNumber=episodeNumber.toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:false,});episodesData+=`<a class="episodes" title="${seasonsDataJSON.name+":E"+formatedEpisodeNumber+". "+episode.name}" cssidentification="s${seasonNumber}e${episodeNumber}" url="imdb=${imdbID}&season=${seasonNumber}&episode=${episodeNumber}&title=${seasonsDataJSON.name.replace(//g,"_")+"_E"+formatedEpisodeNumber+"_"+episode.name.replace(//g,"_")}" onClick="event.preventDefault();setVideo(this);setUrl(this);" href="${PLAYER_CONFIG.embedTvUrl(showId,seasonNumber,episodeNumber)}">E${formatedEpisodeNumber}. ${episode.name}</a>`;}episodeContainer.innerHTML=episodesData;webSeriesData.appendChild(episodeContainer);episodeHighlight();}let searchParams=new URLSearchParams(window.location.search);let season=searchParams.get("season");let episode=searchParams.get("episode");if(season && episode){document .querySelector(`a[cssIdentification="s${season}e${episode}"]`).click();}else if(season && !episode){document.querySelector(`a[cssIdentification="s${season}e1"]`).click();}else{document.querySelector(`a[cssIdentification="s1e1"]`).click();}}printEpisodes();}else{}window.dataLayer=window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js",new Date());gtag("config","G-THTQ9GZQ0J");highlightCards();return false;}
